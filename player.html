<!DOCTYPE html>
<html>

<head>
 <meta charset="UTF-8">
 <meta name="viewport" content="width=device-width, initial-scale=1">
 <title> Megabrain lecture Player </title>
 <style>
  * {
   margin: 0;
   padding: 0;
   outline: none;
   box-sizing: border-box;
   text-decoration: none;
  }

  body {
   background: #DEDEDE;
  }

  #player {
   border: none;
   width: 100%;
   margin-top: 30px;
  }

  video {
   width: 100%;
   height: 250px;
  }

  button {
   height: 30px;
   color: royalblue;
   float: right;
   border: none;
   border-radius: 5px;
   padding: 5px;
   margin: 10px;
  }

  #lecture_info {
   height: 300px;
   width: 100%;
   padding: 20px;
   clear: both;
  }

  #lecture_title,
  #tips {
   color: Royalblue;
   text-shadow: 0px 0px 1px #000;
   margin: 5px;
   font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
  }

  #lecture_text {
   padding: 10px;
   font-size: 15px;
   font-weight: 500;
   text-align: left;
   word-spacing: 4px;
   letter-spacing: 1px;
  }

  #RP {
   color: royalblue;
   margin: 35px 0;
   padding: 35px 0;
  }
  div{
   margin: 10px 0;
  }
 </style>
</head>

<body id="body">
 <section id="player-cont">
  <div id="player">
   <video poster="./MegaBrain/Logo.jpg" preload='auto' controls controlsList="nodownloads" id="my-vid">
    <source id="video" src="" type="video/mov">
   </video>
   <button onclick="openFullscreen();">Open Video in Fullscreen Mode</button>
  </div>
  <div id="lecture_info">
   <h2 id="lecture_title">
    Introduction
   </h2>
   <p id="lecture_text">
   </p>
   <p id="RP">
    <a href="https://forms.gle/r62WAFcgbMmraVbr6">
     <strong> Report A Problem </strong>
    </a>
   </p>
  </div>

 </section>
 <script>
  var vid = document.getElementById("my-vid");
  var title = document.getElementById("lecture_title");
  var info = document.getElementById("lecture_text");

  function openFullscreen() {
   if (vid.requestFullscreen) {
    vid.requestFullscreen();
   } else if (vid.webkitRequestFullscreen) {
    /* Safari */
    vid.webkitRequestFullscreen();
   } else if (vid.msRequestFullscreen) {
    /* IE11 */
    vid.msRequestFullscreen();
   }
  }
  var OBJ = fetch('./videos.json')
   .then(
    data => data.json()
   )
   .then(
    res => {
     var date = new Date();
     var day = date.getUTCDate();

     function updateVid(day) {
      res.forEach(
       video_obj => {
        if (video_obj.inp == day) {
         console.log("loaded");
         vid.src = video_obj.out;
         title.innerHTML = video_obj.title;
         info.innerHTML = 'Day : ' + video_obj.day+'<br/><br/>'+video_obj.info;
        }
       }
      )
     }
     updateVid(day);
    });

  document.querySelector('body').addEventListener('contextmenu',
  () =>
   alert("This video does not belong to Megabrain, You cannot save this video for copyright reasons. Sorry about that.")
   );


  /*  window.onload = function() {
     var OBJ = fetch('./videos.json')
      .then(
       data => data.json()
      )
      .then(
       res => {
        var date = new Date();
        var day = date.getUTCDate();

        function updateVid(day) {
         var xhr = new XMLHttpRequest();

         res.forEach(
          video_obj => {
           if (video_obj.inp == day) {
            xhr.open('POST', video_obj.out, true);
            xhr.responseType = 'blob'; //important
            xhr.onload = function(e) {
             if (this.status == 200) {
              console.log("loaded");
              var blob = this.response;
              var video = document.getElementById('my-vid');
              video.oncanplaythrough = function() {
               console.log("Can play through video without stopping");
               URL.revokeObjectURL(this.src);
              };
              video.src = URL.createObjectURL(blob);
              video.load();
             }
             console.log(video.src);
            }
            xhr.send();
           }
          })

        };
        updateVid(day);

       })
    }*/
 </script>

</body>

</html>